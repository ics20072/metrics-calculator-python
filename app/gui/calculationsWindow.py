# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'gui/calculationsWindow.ui'
#
# Created by: PyQt5 UI code generator 5.15.7
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from src.metrics.calculator.metrics_calculator import MetricsCalculator
# import main window
# from mainWindow import Ui_MainWindow


class Ui_metricsWindow(object):
    def setupUi(self, metricsWindow, project):
        self.project = project
        self.classes = MetricsCalculator.calcNOC(self.project.get_files())
        metricsWindow.setObjectName("metricsWindow")
        # set the size
        metricsWindow.setFixedSize(846, 762)
        metricsWindow.setStyleSheet("background-color:#224562;")
        self.projectNameLbl_2 = QtWidgets.QLabel(metricsWindow)
        self.projectNameLbl_2.setGeometry(QtCore.QRect(40, 30, 731, 31))
        font = QtGui.QFont()
        font.setPointSize(16)
        font.setBold(True)
        font.setWeight(75)
        self.projectNameLbl_2.setFont(font)
        self.projectNameLbl_2.setStyleSheet("color: #FFD43B;")
        self.projectNameLbl_2.setObjectName("projectNameLbl_2")
        self.nocLbl = QtWidgets.QLabel(metricsWindow)
        self.nocLbl.setGeometry(QtCore.QRect(550, 70, 261, 20))
        font = QtGui.QFont()
        font.setPointSize(8)
        font.setBold(False)
        font.setWeight(50)
        self.nocLbl.setFont(font)
        self.nocLbl.setStyleSheet("color: #FFD43B;")
        self.nocLbl.setObjectName("nocLbl")
        self.exportExcelBtn = QtWidgets.QPushButton(metricsWindow)
        self.exportExcelBtn.setGeometry(QtCore.QRect(430, 670, 291, 51))
        font = QtGui.QFont()
        font.setPointSize(10)
        font.setBold(True)
        font.setWeight(75)
        self.exportExcelBtn.setFont(font)
        self.exportExcelBtn.setStyleSheet("color:white;\n"
                                          "font-weight: bold;\n"
                                          "background-color: #00A300;")
        self.exportExcelBtn.setObjectName("exportExcelBtn")
        self.backMainBtn = QtWidgets.QPushButton(metricsWindow)
        self.backMainBtn.setGeometry(QtCore.QRect(140, 670, 241, 51))
        font = QtGui.QFont()
        font.setPointSize(10)
        font.setBold(True)
        font.setWeight(75)
        self.backMainBtn.setFont(font)
        self.backMainBtn.setStyleSheet("color:white;\n"
                                       "font-weight: bold;\n"
                                       "background-color: #B68F05;;")
        self.backMainBtn.setObjectName("backMainBtn")
        self.metricsTbl = QtWidgets.QTableWidget(metricsWindow)
        self.metricsTbl.setGeometry(QtCore.QRect(30, 100, 791, 541))
        font = QtGui.QFont()
        font.setPointSize(9)
        self.metricsTbl.setFont(font)
        self.metricsTbl.setStyleSheet("background-color:white;")
        self.metricsTbl.setShowGrid(True)
        self.metricsTbl.setGridStyle(QtCore.Qt.DashLine)
        self.metricsTbl.setRowCount(self.classes + 1)
        self.metricsTbl.setColumnCount(12)
        self.metricsTbl.setObjectName("metricsTbl")
        classNameLbl = QtWidgets.QTableWidgetItem()
        locLbl = QtWidgets.QTableWidgetItem()
        nomLbl = QtWidgets.QTableWidgetItem()
        size2Lbl = QtWidgets.QTableWidgetItem()
        noccLbl = QtWidgets.QTableWidgetItem()
        ditLbl = QtWidgets.QTableWidgetItem()
        wmpc1Lbl = QtWidgets.QTableWidgetItem()
        wmpc2Lbl = QtWidgets.QTableWidgetItem()
        rfcLbl = QtWidgets.QTableWidgetItem()
        cboLbl = QtWidgets.QTableWidgetItem()
        mpcLbl = QtWidgets.QTableWidgetItem()
        lcomLbl = QtWidgets.QTableWidgetItem()
        _translate = QtCore.QCoreApplication.translate
        for python_file in self.project.get_files():
           for index, classObj in enumerate(python_file.getFileClasses()):
               self.metricsTbl.setItem(index + 1,0,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 0).setText(_translate("metricsWindow", classObj.get_name()))
               self.metricsTbl.setItem(index + 1,1,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 1).setText(_translate("metricsWindow", str(classObj.getSizeCategoryMetrics().getLOC())))
               self.metricsTbl.setItem(index + 1,2,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 2).setText(_translate("metricsWindow", str(classObj.getSizeCategoryMetrics().getNOM())))
               self.metricsTbl.setItem(index + 1,3,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 3).setText(_translate("metricsWindow", str(classObj.getSizeCategoryMetrics().getSIZE2())))
               self.metricsTbl.setItem(index + 1,4,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 4).setText(_translate("metricsWindow", str(classObj.getSizeCategoryMetrics().getNOCC())))
               self.metricsTbl.setItem(index + 1,5,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 5).setText(_translate("metricsWindow", str(classObj.getComplexityCategoryMetrics().getDIT())))
               self.metricsTbl.setItem(index + 1,6,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 6).setText(_translate("metricsWindow", str(classObj.getComplexityCategoryMetrics().getWMPC1())))
               self.metricsTbl.setItem(index + 1,7,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 7).setText(_translate("metricsWindow", str(classObj.getComplexityCategoryMetrics().getWMPC2())))
               self.metricsTbl.setItem(index + 1,8,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 8).setText(_translate("metricsWindow", str(classObj.getComplexityCategoryMetrics().getRFC())))
               self.metricsTbl.setItem(index + 1,9,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 9).setText(_translate("metricsWindow", str(classObj.getCouplingCategoryMetrics().get_CBO())))
               self.metricsTbl.setItem(index + 1,10,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 10).setText(_translate("metricsWindow", str(classObj.getCouplingCategoryMetrics().get_MPC())))
               self.metricsTbl.setItem(index + 1,11,QtWidgets.QTableWidgetItem())
               self.metricsTbl.item(index + 1, 11).setText(_translate("metricsWindow", str(classObj.getCohesionCategoryMetrics().get_LCOM())))
               
        self.metricsTbl.setItem(0, 0, classNameLbl)       
        self.metricsTbl.setItem(0, 1, locLbl)
        self.metricsTbl.setItem(0, 2, nomLbl)
        self.metricsTbl.setItem(0, 3, size2Lbl)
        self.metricsTbl.setItem(0, 4, noccLbl)
        self.metricsTbl.setItem(0, 5, ditLbl)
        self.metricsTbl.setItem(0, 6, wmpc1Lbl)
        self.metricsTbl.setItem(0, 7, wmpc2Lbl)
        self.metricsTbl.setItem(0, 8, rfcLbl)
        self.metricsTbl.setItem(0, 9, cboLbl)
        self.metricsTbl.setItem(0, 10, mpcLbl)
        self.metricsTbl.setItem(0, 11, lcomLbl)
        self.metricsTbl.verticalHeader().setMinimumSectionSize(23)
        self.helpBtn_2 = QtWidgets.QToolButton(metricsWindow)
        self.helpBtn_2.setGeometry(QtCore.QRect(790, 710, 31, 31))
        font = QtGui.QFont()
        font.setPointSize(10)
        font.setBold(True)
        font.setWeight(75)
        self.helpBtn_2.setFont(font)
        self.helpBtn_2.setStyleSheet("color:white;\n"
                                     "font-weight: bold;\n"
                                     "background-color: #B68F05;")
        self.helpBtn_2.setObjectName("helpBtn_2")

        # set click listeners
        # self.backMainBtn.clicked.connect(self.backToMain)

        self.retranslateUi(metricsWindow)
        QtCore.QMetaObject.connectSlotsByName(metricsWindow)

    def retranslateUi(self, metricsWindow):
        _translate = QtCore.QCoreApplication.translate
        metricsWindow.setWindowTitle(_translate("metricsWindow", "Calculations"))
        # set favicon
        metricsWindow.setWindowIcon(QtGui.QIcon("gui\\../resources/images/favicons/favicon.png"))
        self.projectNameLbl_2.setText(_translate("metricsWindow", "Metrics for " + self.project.get_name()))
        self.nocLbl.setText(_translate("metricsWindow", "Classes Found (NOC Metric) = " + str(self.classes)))
        self.exportExcelBtn.setText(_translate("metricsWindow", "Export Results to Excel File"))
        self.backMainBtn.setText(_translate("metricsWindow", "Back to main screen"))
        self.metricsTbl.setSortingEnabled(False)
        __sortingEnabled = self.metricsTbl.isSortingEnabled()
        self.metricsTbl.setSortingEnabled(False)
        classNameLbl = self.metricsTbl.item(0, 0)
        classNameLbl.setText(_translate("metricsWindow", "Class Name"))
        locLbl = self.metricsTbl.item(0, 1)
        locLbl.setText(_translate("metricsWindow", "LOC"))
        nomLbl = self.metricsTbl.item(0, 2)
        nomLbl.setText(_translate("metricsWindow", "NOM"))
        size2Lbl = self.metricsTbl.item(0, 3)
        size2Lbl.setText(_translate("metricsWindow", "SIZE2"))
        noccLbl = self.metricsTbl.item(0, 4)
        noccLbl.setText(_translate("metricsWindow", "NOCC"))
        ditLbl = self.metricsTbl.item(0, 5)
        ditLbl.setText(_translate("metricsWindow", "DIT"))
        wmpc1Lbl = self.metricsTbl.item(0, 6)
        wmpc1Lbl.setText(_translate("metricsWindow", "WPMC1"))
        wmpc2Lbl = self.metricsTbl.item(0, 7)
        wmpc2Lbl.setText(_translate("metricsWindow", "WMPC2"))
        rfcLbl = self.metricsTbl.item(0, 8)
        rfcLbl.setText(_translate("metricsWindow", "RFC"))
        cboLbl = self.metricsTbl.item(0, 9)
        cboLbl.setText(_translate("metricsWindow", "CBO"))
        mpcLbl = self.metricsTbl.item(0, 10)
        mpcLbl.setText(_translate("metricsWindow", "MPC"))
        lcomLbl = self.metricsTbl.item(0, 11)
        lcomLbl.setText(_translate("metricsWindow", "LCOM"))
        
        
        self.metricsTbl.setSortingEnabled(__sortingEnabled)
        self.helpBtn_2.setText(_translate("metricsWindow", "?"))

    # method that goes to main
    # def backToMain(self):
    #     self.window = QtWidgets.QMainWindow()
    #     self.ui = Ui_MainWindow()
    #     self.ui.setupUi(self.window)
    #     self.window.show()
    #     metricsWindow.close()


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    metricsWindow = QtWidgets.QDialog()
    ui = Ui_metricsWindow()
    ui.setupUi(metricsWindow)
    metricsWindow.show()
    sys.exit(app.exec_())
